

```python
WARN: Relocs has not been applied. Please use `-e bin.relocs.apply=true` or `-e bin.cache=true` next time
[0x004004d0]> aaa
INFO: Analyze all flags starting with sym. and entry0 (aa)
INFO: Analyze imports (af@@@i)
INFO: Analyze entrypoint (af@ entry0)
INFO: Analyze symbols (af@@@s)
INFO: Analyze all functions arguments/locals (afva@@@F)
INFO: Analyze function calls (aac)
INFO: Analyze len bytes of instructions for references (aar)
INFO: Finding and parsing C++ vtables (avrr)
INFO: Analyzing methods (af @@ method.*)
INFO: Recovering local variables (afva@@@F)
INFO: Type matching analysis for all functions (aaft)
INFO: Propagate noreturn information (aanr)
INFO: Use -AA or aaaa to perform additional experimental analysis
[0x004004d0]> s sym.main
[0x004005bd]> pdf
            ; ICOD XREF from entry0 @ 0x4004ed(r)
â”Œ 119: int main (uint32_t argc, char **argv);
â”‚ `- args(rdi, rsi) vars(2:sp[0xc..0x18])
â”‚           0x004005bd      55             push rbp
â”‚           0x004005be      4889e5         mov rbp, rsp
â”‚           0x004005c1      4883ec10       sub rsp, 0x10
â”‚           0x004005c5      897dfc         mov dword [var_4h], edi     ; argc
â”‚           0x004005c8      488975f0       mov qword [s1], rsi         ; argv
â”‚           0x004005cc      837dfc02       cmp dword [var_4h], 2
â”‚       â”Œâ”€< 0x004005d0      7551           jne 0x400623
â”‚       â”‚   0x004005d2      488b45f0       mov rax, qword [s1]
â”‚       â”‚   0x004005d6      4883c008       add rax, 8
â”‚       â”‚   0x004005da      488b00         mov rax, qword [rax]
â”‚       â”‚   0x004005dd      4889c6         mov rsi, rax
â”‚       â”‚   0x004005e0      bfc4064000     mov edi, str.Checking_License:__s_n ; 0x4006c4 ; "Checking License: %s\n" ; const char *format
â”‚       â”‚   0x004005e5      b800000000     mov eax, 0
â”‚       â”‚   0x004005ea      e8a1feffff     call sym.imp.printf         ; int printf(const char *format)
â”‚       â”‚   0x004005ef      488b45f0       mov rax, qword [s1]
â”‚       â”‚   0x004005f3      4883c008       add rax, 8
â”‚       â”‚   0x004005f7      488b00         mov rax, qword [rax]
â”‚       â”‚   0x004005fa      beda064000     mov esi, str.AAAA_Z10N_42_OK ; 0x4006da ; "AAAA-Z10N-42-OK" ; const char *s2
â”‚       â”‚   0x004005ff      4889c7         mov rdi, rax                ; const char *s1
â”‚       â”‚   0x00400602      e8a9feffff     call sym.imp.strcmp         ; int strcmp(const char *s1, const char *s2)
â”‚       â”‚   0x00400607      85c0           test eax, eax
â”‚      â”Œâ”€â”€< 0x00400609      750c           jne 0x400617
â”‚      â”‚â”‚   0x0040060b      bfea064000     mov edi, str.Access_Granted_ ; 0x4006ea ; "Access Granted!" ; const char *s
â”‚      â”‚â”‚   0x00400610      e86bfeffff     call sym.imp.puts           ; int puts(const char *s)
â”‚     â”Œâ”€â”€â”€< 0x00400615      eb16           jmp 0x40062d
â”‚     â”‚â”‚â”‚   ; CODE XREF from main @ 0x400609(x)
â”‚     â”‚â””â”€â”€> 0x00400617      bffa064000     mov edi, str.WRONG_         ; 0x4006fa ; "WRONG!" ; const char *s
â”‚     â”‚ â”‚   0x0040061c      e85ffeffff     call sym.imp.puts           ; int puts(const char *s)
â”‚     â”‚â”Œâ”€â”€< 0x00400621      eb0a           jmp 0x40062d
â”‚     â”‚â”‚â”‚   ; CODE XREF from main @ 0x4005d0(x)
â”‚     â”‚â”‚â””â”€> 0x00400623      bf01074000     mov edi, str.Usage:__key_   ; 0x400701 ; "Usage: <key>" ; const char *s
â”‚     â”‚â”‚    0x00400628      e853feffff     call sym.imp.puts           ; int puts(const char *s)
â”‚     â”‚â”‚    ; CODE XREFS from main @ 0x400615(x), 0x400621(x)
â”‚     â””â””â”€â”€> 0x0040062d      b800000000     mov eax, 0
â”‚           0x00400632      c9             leave
â””           0x00400633      c3             ret
[0x004005bd]> ood AAAA-WRONG-KEY
INFO: File dbg:///home/itsjustme/Documents/github/liveoverflow_youtube/0x05_simple_crackme_intro_assembler/license_1 AAAA-WRONG-KEY reopened in read-write mode
WARN: Relocs has not been applied. Please use `-e bin.relocs.apply=true` or `-e bin.cache=true` next time
2457
[0x7fa1432df5c0]> dc
Checking License: AAAA-WRONG-KEY
WRONG!
(2457) Process exited with status=0x0
[0x7fa14317f295]> db 0x00400609
[0x7fa14317f295]> ood
(2457) Process terminated with status 0
INFO: ==> Process finished
INFO: File dbg:///home/itsjustme/Documents/github/liveoverflow_youtube/0x05_simple_crackme_intro_assembler/license_1 reopened in read-write mode
WARN: Relocs has not been applied. Please use `-e bin.relocs.apply=true` or `-e bin.cache=true` next time
2461
[0x7f72a2b5c5c0]> ood AAAA-WRONG-KEY
child received signal 9
INFO: File dbg:///home/itsjustme/Documents/github/liveoverflow_youtube/0x05_simple_crackme_intro_assembler/license_1 AAAA-WRONG-KEY reopened in read-write mode
WARN: Relocs has not been applied. Please use `-e bin.relocs.apply=true` or `-e bin.cache=true` next time
2462
[0x7fedbcbf25c0]> dc
Checking License: AAAA-WRONG-KEY
INFO: hit breakpoint at: 0x400609
[0x00400609]> dr
rax = 0xfffffffd
rbx = 0x7ffcf2868d48
rcx = 0x0000005a
rdx = 0x00000000
r8 = 0x00000000
r9 = 0x00000000
r10 = 0x00000003
r11 = 0x7fedbcb1b970
r12 = 0x00000000
r13 = 0x7ffcf2868d60
r14 = 0x7fedbcc0c000
r15 = 0x00000000
rsi = 0x004006da
rdi = 0x7ffcf2869d7b
rsp = 0x7ffcf2868c20
rbp = 0x7ffcf2868c30
rip = 0x00400609
rflags = 0x00000282
orax = 0xffffffffffffffff
[0x00400609]> dr rip=0x0040060b
0x00400609 -> 0x0040060b
[0x00400609]> dr
rax = 0xfffffffd
rbx = 0x7ffcf2868d48
rcx = 0x0000005a
rdx = 0x00000000
r8 = 0x00000000
r9 = 0x00000000
r10 = 0x00000003
r11 = 0x7fedbcb1b970
r12 = 0x00000000
r13 = 0x7ffcf2868d60
r14 = 0x7fedbcc0c000
r15 = 0x00000000
rsi = 0x004006da
rdi = 0x7ffcf2869d7b
rsp = 0x7ffcf2868c20
rbp = 0x7ffcf2868c30
rip = 0x0040060b
rflags = 0x00000282
orax = 0xffffffffffffffff
[0x00400609]> dc
Access Granted!
(2462) Process exited with status=0x0
```

### Summary:

**Target Binary:** `license_1`  
**Tool Used:** `radare2`  
**Goal:** Bypass the license key check in a simple CrackMe and always print `Access Granted!`

---

### ðŸ§  Analysis Steps

1. **Opened binary with r2 and analyzed it:**
```shell
r2 ./license_1
aaa  # Run full analysis
s sym.main  # Seek to main()
pdf  # Print disassembled function

```

2. **Understood program logic:**

	- If `argc != 2`, show usage.
    
	- If `argv[1] == "AAAA-Z10N-42-OK"`, print `Access Granted!`.
    
	- Else, print `WRONG!`.

3. **Tried running with an invalid key:**

```shell
ood AAAA-WRONG-KEY
dc
```

	-  Output: `Checking License: AAAA-WRONG-KEY` â†’ `WRONG!`

4. Set a breakpoint at failure check:

```shell
db 0x00400609  # jne (jump if wrong license)
ood AAAA-WRONG-KEY
dc  # Hit breakpoint

```

5. Modified control flow by changing RIP:

```shell
dr rip=0x0040060b  # Skip jne and go to Access Granted
dc
```

- Output : `Granted!`

### âœ… Result

Successfully bypassed license key check without modifying the binary file, using **runtime debugging** by skipping the conditional jump (`jne`) that handles failed key checks.


## Reflection:

