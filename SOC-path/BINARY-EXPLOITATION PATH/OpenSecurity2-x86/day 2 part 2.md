### ðŸ”§ **Program Structure**

Youâ€™re dealing with two functions:

- `main()`
    
- `sub()` â€” which is called by `main()`.
    

Assembly operations:

- `push ebp`
    
- `mov ebp, esp`
    
- `call sub`
    
- `mov eax, 0BEEFh`
    
- `mov eax, 0F00Dh`
    
- `pop ebp`
    
- `ret`
    

---

### ðŸ§  Core Concepts Recap

| Concept         | Description                                                                                 |
| --------------- | ------------------------------------------------------------------------------------------- |
| **EIP**         | Instruction pointer (address of the next instruction to execute).                           |
| **EBP**         | Base pointer (used for stack frame management).                                             |
| **ESP**         | Stack pointer (points to the current top of the stack).                                     |
| **Stack Frame** | Memory layout for a functionâ€™s local variables, return address, and previous frame pointer. |
| **Call**        | Pushes return address, then jumps.                                                          |
| **Ret**         | Pops return address off stack and jumps there.                                              |
| **Push/pop**    | Alters ESP and stores/removes values to/from the stack.                                     |
### ðŸ§© Step-by-Step Breakdown

#### ðŸ§­ **Before `main()`**

- `ESP` starts at `0x0012FF6C`
    
- `EBP` is undefined
    

#### âœ… **Step 1: `main` begins execution**

- `push ebp`: Save callerâ€™s `ebp` on stack.
    
- `mov ebp, esp`: Set current base frame pointer.
    
- `call sub`: Push return address (e.g., `0x00401018`) and jump to `sub()`.
    

---

#### âœ… **Step 2: `sub()` begins execution**

- `push ebp`: Save `main`'s `ebp` (e.g., `0x0012FF68`)
    
- `mov ebp, esp`: Now `sub()` uses its own base pointer.
    
- `mov eax, 0F00Dh`: Just loads `eax`.
    
- `pop ebp`: Restore `main`'s `ebp`.
    
- `ret`: Return to caller by popping `0x00401018` to EIP.
    

---

#### âœ… **Back to `main()`**

- `mov eax, 0BEEFh`: Overwrites `eax` with a new value.
    
- `pop ebp`: Restore callerâ€™s frame.
    
- `ret`: Program returns (end).
    

---

### ðŸ“Š What You See in the Images (Example1.c 1 to 9)

|Example|Highlight|
|---|---|
|1|Before execution.|
|2|Stack right after `main` sets up.|
|3â€“4|Transition into `sub()` (return address and new `ebp` pushed).|
|5â€“6|`sub()` executes `mov eax, 0F00Dh`.|
|7â€“8|Returning from `sub()`, `eax` becomes `0xBEEF`, `ebp` restored.|
|9|All frames cleaned up â€” program ends.|

### ðŸ’¡ Tips

- Every function call adds a _new frame_ on the stack.
    
- When the function ends, the frame is popped off.
    
- These examples are a classic way to learn function calling and stack behavior in **x86**.